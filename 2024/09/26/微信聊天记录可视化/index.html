<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;zh-HK&quot;,&quot;ja&quot;,&quot;ko&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>微信聊天记录可视化 | AquaMind✨</title><meta name="author" content="AquaMind"><meta name="copyright" content="AquaMind"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="利用Python将微信聊天记录生成可视化PDF报告">
<meta property="og:type" content="article">
<meta property="og:title" content="微信聊天记录可视化">
<meta property="og:url" content="http://example.com/2024/09/26/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%AF%E8%A7%86%E5%8C%96/index.html">
<meta property="og:site_name" content="AquaMind✨">
<meta property="og:description" content="利用Python将微信聊天记录生成可视化PDF报告">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/default_cover.jpg">
<meta property="article:published_time" content="2024-09-26T04:56:22.630Z">
<meta property="article:modified_time" content="2024-12-11T12:38:49.858Z">
<meta property="article:author" content="AquaMind">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/default_cover.jpg"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="http://example.com/2024/09/26/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%AF%E8%A7%86%E5%8C%96/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '微信聊天记录可视化',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"><link rel="stylesheet" href="/css/btstyle.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/backgroud.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/statics/"><i class="fa-fw fa-solid fa-chart-simple"></i><span> Statics</span></a></li><li><a class="site-page child" href="/categories/python/"><i class="fa-fw fa-brands fa-python"></i><span> Python</span></a></li><li><a class="site-page child" href="/categories/hexo/"><i class="fa-fw fa-solid fa-share-from-square"></i><span> Hexo</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/微信聊天可视化/封面.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">AquaMind✨</span></a><a class="nav-page-title" href="/"><span class="site-name">微信聊天记录可视化</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/statics/"><i class="fa-fw fa-solid fa-chart-simple"></i><span> Statics</span></a></li><li><a class="site-page child" href="/categories/python/"><i class="fa-fw fa-brands fa-python"></i><span> Python</span></a></li><li><a class="site-page child" href="/categories/hexo/"><i class="fa-fw fa-solid fa-share-from-square"></i><span> Hexo</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">微信聊天记录可视化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-26T04:56:22.630Z" title="发表于 2024-09-26 12:56:22">2024-09-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-11T12:38:49.858Z" title="更新于 2024-12-11 20:38:49">2024-12-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>谨慎食用</p>
<h2 id="数据获取"><a href="#数据获取" class="headerlink" title="数据获取"></a>数据获取</h2><h3 id="电脑端迁移聊天记录"><a href="#电脑端迁移聊天记录" class="headerlink" title="电脑端迁移聊天记录"></a>电脑端迁移聊天记录</h3><ul>
<li>迁移手机和接收电脑设置在同一局域网内【手机电脑连同一WiFi】</li>
<li>微信-通用-聊天记录-聊天记录迁移与备份-迁移-迁移到电脑【可选迁移全部聊天记录】或【迁移指定聊天记录】</li>
<li>确认电脑端聊天记录是否成功，若成功，手机退出微信运行，重启打开。</li>
</ul>
<h3 id="下载留痕软件-获取电脑端微信聊天记录"><a href="#下载留痕软件-获取电脑端微信聊天记录" class="headerlink" title="下载留痕软件 获取电脑端微信聊天记录"></a>下载留痕软件 获取电脑端微信聊天记录</h3><ul>
<li><a target="_blank" rel="noopener" href="https://memotrace.cn/">开源软件留痕下载地址</a>，选择对应下载版本。【好像只支持Windows版本，mac系统的姐妹收手吧】 </li>
<li>运行文件中的MemoTrace.exe-获取信息-点击解析 等待数据解析完成即可。</li>
<li>点击好友-再点击好友对象，即可获取与好友的聊天信息分析。<br>PS：如果发现信息解析不完全，但确认聊天记录已在电脑端，退出电脑微信重新登录且关闭MemoTrace.exe，重新开启解析即可。</li>
</ul>
<h3 id="导出数据"><a href="#导出数据" class="headerlink" title="导出数据"></a>导出数据</h3><ul>
<li>程序开源作者已经提供初步的分析,但如果想要更细致更个性化的分析,可导出数据自行分析。点击聊天记录导出-导出CSV，【但导出的csv数据只有聊天文字信息】</li>
<li>导出数据如下图所示：<img src="/img/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E5%8F%AF%E8%A7%86%E5%8C%96/exe%E5%AF%BC%E5%87%BA%E8%AE%B0%E5%BD%95.png" class=""></li>
</ul>
<h2 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><h4 id="导入第三方库"><a href="#导入第三方库" class="headerlink" title="导入第三方库"></a>导入第三方库</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas as pd</span><br><span class="line"><span class="keyword">import</span> numpy as np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot as plt</span><br><span class="line">from scipy.interpolate <span class="keyword">import</span> make_interp_spline</span><br><span class="line"><span class="keyword">import</span> seaborn as sns</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">from wordcloud <span class="keyword">import</span> WordCloud</span><br><span class="line">from collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">from aip <span class="keyword">import</span> AipNlp</span><br><span class="line">from snownlp <span class="keyword">import</span> SnowNLP</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">from datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> pptx</span><br><span class="line">from spire.presentation <span class="keyword">import</span> *</span><br><span class="line">from spire.presentation.common <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"># 使用<span class="type">SimHei字体支持中文显示</span></span><br><span class="line">plt.rcParams[&#x27;font.sans<span class="operator">-</span>serif&#x27;] <span class="operator">=</span> [&#x27;<span class="type">KaiTi</span>&#x27;]  # 设置默认字体为 <span class="type">KaiTi</span></span><br><span class="line">plt.rcParams[&#x27;axes.unicode_minus&#x27;] <span class="operator">=</span> <span class="type">False</span>    # 解决负号显示问题</span><br></pre></td></tr></table></figure>
<h4 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h4><p>– 前6个字段数据类型为int64,后面字段数据类型为object。<br>– Type: 发送内容的类型<br>– IsSender: 是否是自己发出的消息，也就是标记消息展示在对话页左边还是右边，取值0或1。<br>– StrContent：信息内容<br>– StrTime: 信息发送时间<br>– Remark: 微信备注<br>– NickName: 微信昵称</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data <span class="operator">=</span> pd.read_csv(&#x27;子一.csv&#x27;)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<img src="/img/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E5%8F%AF%E8%A7%86%E5%8C%96/%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96.png" class="">

<ul>
<li>生成保存图片的文件夹<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 检查文件夹是否存在,如果文件夹不存在,则创建</span><br><span class="line"></span><br><span class="line">folder_path <span class="operator">=</span> &#x27;图片信息&#x27;</span><br><span class="line"><span class="keyword">if</span> not os.path.exists(folder_path):</span><br><span class="line">    os.makedirs(folder_path)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="图像绘制函数"><a href="#图像绘制函数" class="headerlink" title="图像绘制函数"></a>图像绘制函数</h4><p>PS：因为下面分析会多次用到下面图像绘制函数,因此先定义图像函数,后面直接调用即可。</p>
<ul>
<li><p>获取字典中值最大的数</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 统计谁最多,res字典格式</span><br><span class="line"></span><br><span class="line">def <span class="type">Get_most_Value</span>(res):</span><br><span class="line">    </span><br><span class="line">    res_key <span class="operator">=</span> <span class="built_in">max</span>(res, key<span class="operator">=</span>res.get)</span><br><span class="line">    res_value <span class="operator">=</span> res[res_key]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> res_key,res_value</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取词频前20个使用频率最高的词汇</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def <span class="type">Get_top20</span>(res):</span><br><span class="line">    top_20 <span class="operator">=</span> dict(sorted(res.items(), key<span class="operator">=</span>lambda item: item[<span class="number">1</span>], reverse<span class="operator">=</span><span class="type">True</span>)[:<span class="number">20</span>])</span><br><span class="line">    <span class="keyword">return</span> top_20</span><br></pre></td></tr></table></figure></li>
<li><p>绘制词云图函数<br>PS：停用词库需下载且放在与py文件同一路径下。若词云图显示字体报错,可查看系统是否安装simkai.ttf字体。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"># 绘制词云图</span><br><span class="line"></span><br><span class="line">def <span class="type">Draw_Yuntu</span>(content,pic_path<span class="operator">=</span><span class="type">None</span>):</span><br><span class="line">    </span><br><span class="line">    # 去掉字符串中的所有符号</span><br><span class="line">    text <span class="operator">=</span> re.sub(r&#x27;[<span class="operator">^</span>\w\s]&#x27;, &#x27;&#x27;, content.replace(&#x27;\n&#x27;,&#x27;&#x27;) )</span><br><span class="line"></span><br><span class="line">    # 使用jieba进行中文分词</span><br><span class="line">    words <span class="operator">=</span> jieba.cut(text, cut_all<span class="operator">=</span><span class="type">False</span>)</span><br><span class="line"></span><br><span class="line">    # 去掉停用词且去掉单字</span><br><span class="line">    ## 读取停用词</span><br><span class="line">    with <span class="keyword">open</span>(&#x27;停用词库.txt&#x27;, encoding<span class="operator">=</span>&#x27;utf<span class="operator">-</span><span class="number">8</span>&#x27;) <span class="keyword">as</span> f:  # 可根据需要打开停用词库，然后加上不想显示的词语</span><br><span class="line">        con <span class="operator">=</span> f.readlines()</span><br><span class="line">        stop_words <span class="operator">=</span> <span class="keyword">set</span>() # 集合可以去重</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> con:</span><br><span class="line">            i <span class="operator">=</span> i.replace(<span class="string">&quot;<span class="subst">\n</span>&quot;</span>, <span class="string">&quot; &quot;</span>)   # 去掉读取每一行数据的\n</span><br><span class="line">            stop_words.add(i)</span><br><span class="line">    stop_words</span><br><span class="line"></span><br><span class="line">    # 去掉停用词和单字</span><br><span class="line">    words_res <span class="operator">=</span> []</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="keyword">if</span> word not <span class="keyword">in</span> stop_words and len(word) <span class="operator">!=</span> <span class="number">1</span>:</span><br><span class="line">            words_res.append(word)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # 计算词频</span><br><span class="line">    word_list <span class="operator">=</span> <span class="type">Counter</span>(words_res)</span><br><span class="line"></span><br><span class="line">    # 生成词云</span><br><span class="line">    wordcloud <span class="operator">=</span> <span class="type">WordCloud</span>(</span><br><span class="line">        font_path<span class="operator">=</span>&#x27;simkai.ttf&#x27;,  # 确保字体路径正确</span><br><span class="line">        width<span class="operator">=</span><span class="number">800</span>,</span><br><span class="line">        height<span class="operator">=</span><span class="number">400</span>,</span><br><span class="line">        background_color<span class="operator">=</span>&#x27;white&#x27;  # 图片背景颜色</span><br><span class="line">    ).generate_from_frequencies(word_list)</span><br><span class="line"></span><br><span class="line">    # 显示词云图</span><br><span class="line">    plt.figure(figsize<span class="operator">=</span>(<span class="number">16</span>, <span class="number">8</span>))</span><br><span class="line">    plt.imshow(wordcloud, interpolation<span class="operator">=</span>&#x27;bilinear&#x27;)</span><br><span class="line">    plt.axis(&#x27;off&#x27;)  # 关闭坐标轴</span><br><span class="line">    </span><br><span class="line">    # 如果有图片路径传入,则保存图片,反之不保存<span class="operator">。</span></span><br><span class="line">    <span class="keyword">if</span> pic_path:</span><br><span class="line">        plt.savefig(pic_path, bbox_inches<span class="operator">=</span>&#x27;tight&#x27;, pad_inches<span class="operator">=</span><span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    # 绘制图像</span><br><span class="line">    plt.show()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> word_list</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>绘制平滑曲线函数<br>PS：注意pic_path参数，传入路径参数，则保存图片;反之，不保存。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># 绘制平滑曲线图</span><br><span class="line"></span><br><span class="line">def <span class="type">Draw_Linegraph</span>(top_20,title_res,pic_path<span class="operator">=</span><span class="type">None</span>):</span><br><span class="line">    </span><br><span class="line">    x <span class="operator">=</span> list( top_20.keys())</span><br><span class="line">    y <span class="operator">=</span>  list( top_20.values())</span><br><span class="line">    </span><br><span class="line">    x_new <span class="operator">=</span> np.linspace(<span class="number">0</span>, len(x) <span class="operator">-</span> <span class="number">1</span>, <span class="number">300</span>)  # <span class="number">300</span>个点进行插值</span><br><span class="line">    spl <span class="operator">=</span> make_interp_spline(np.arange(len(x)), y, k<span class="operator">=</span><span class="number">3</span>)  # 使用样条插值</span><br><span class="line">    y_new <span class="operator">=</span> spl(x_new)</span><br><span class="line"></span><br><span class="line">    # 创建折线图</span><br><span class="line">    plt.figure(figsize<span class="operator">=</span>(<span class="number">20</span>,<span class="number">6</span>))  # 调整图像大小</span><br><span class="line">    plt.plot(x_new, y_new, color<span class="operator">=</span>&#x27;b&#x27;, label<span class="operator">=</span>&#x27;数据线&#x27;, linewidth<span class="operator">=</span><span class="number">2</span>)  # 更平滑的曲线</span><br><span class="line"></span><br><span class="line">    # 添加标题和标签</span><br><span class="line">    plt.title(title_res, fontsize<span class="operator">=</span><span class="number">24</span>)</span><br><span class="line">    plt.xlabel(&#x27;&#x27;)</span><br><span class="line">    plt.ylabel(&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">    # 设置横坐标刻度</span><br><span class="line">    plt.xticks(ticks<span class="operator">=</span>np.arange(len(x)), labels<span class="operator">=</span>x, rotation<span class="operator">=</span><span class="number">45</span>, fontsize<span class="operator">=</span><span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">    # 设置<span class="type">X轴的范围，减少标签之间的空隙</span></span><br><span class="line">    plt.xlim(<span class="operator">-</span><span class="number">0.5</span>, len(x) <span class="operator">-</span> <span class="number">0.5</span>)  # 调整<span class="type">X轴范围</span></span><br><span class="line"></span><br><span class="line">    # 隐藏所有网格线</span><br><span class="line">    plt.grid(<span class="type">False</span>)  # 关闭网格线</span><br><span class="line"></span><br><span class="line">    # 显示图形</span><br><span class="line">    plt.tight_layout()  # 自动调整子图参数，使之填充整个图像区域</span><br><span class="line">    </span><br><span class="line">    # 如果有图片路径传入,则保存图片,反之不保存<span class="operator">。</span></span><br><span class="line">    <span class="keyword">if</span> pic_path:</span><br><span class="line">        plt.savefig(pic_path)</span><br><span class="line">    </span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure></li>
<li><p>绘制热力图函数<br>PS：注意pic_path参数，传入路径参数，则保存图片;反之，不保存。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def <span class="type">Draw_Heatmap</span>(pic_data,pic_path<span class="operator">=</span><span class="type">None</span>):</span><br><span class="line"></span><br><span class="line">    # 绘制热力图</span><br><span class="line">    plt.figure(figsize<span class="operator">=</span>(<span class="number">20</span>,<span class="number">6</span>))  # 将图像调整为更大的正方形尺寸</span><br><span class="line">    sns.heatmap(pic_data, annot<span class="operator">=</span><span class="type">False</span>, cmap<span class="operator">=</span>&#x27;<span class="type">YlGnBu</span>&#x27;, cbar<span class="operator">=</span><span class="type">True</span>, square<span class="operator">=</span><span class="type">True</span>, </span><br><span class="line">                cbar_kws<span class="operator">=</span>&#123;&#x27;shrink&#x27;: <span class="number">0.5</span>&#125;)  # 调整颜色条大小，shrink 控制缩小比例</span><br><span class="line"></span><br><span class="line">    # 设置图表标签</span><br><span class="line">    plt.title(&#x27;热力图&#x27;)</span><br><span class="line">    plt.xlabel(&#x27;&#x27;)</span><br><span class="line">    plt.ylabel(&#x27;&#x27;)</span><br><span class="line">    </span><br><span class="line">    # 如果有图片路径传入,则保存图片,反之不保存<span class="operator">。</span></span><br><span class="line">    <span class="keyword">if</span> pic_path:</span><br><span class="line">        plt.savefig(pic_path)</span><br><span class="line"></span><br><span class="line">    # 显示图表</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">None</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>绘制饼图函数<br>PS：注意pic_path参数，传入路径参数，则保存图片;反之，不保存。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">def <span class="type">Draw_Piechart</span>(res,res_title,pic_path<span class="operator">=</span><span class="type">None</span>):</span><br><span class="line">    </span><br><span class="line">    labels <span class="operator">=</span> res.keys()</span><br><span class="line">    counts <span class="operator">=</span> res.values()</span><br><span class="line">    </span><br><span class="line">    # 随机颜色列表</span><br><span class="line">    colors <span class="operator">=</span> [<span class="string">&quot;darkorange&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;navajowhite&quot;</span>, <span class="string">&quot;bisque&quot;</span>, <span class="string">&quot;antiquewhite&quot;</span>, <span class="string">&quot;cornsilk&quot;</span>, <span class="string">&quot;lightyellow&quot;</span>]</span><br><span class="line">    random.shuffle(colors)</span><br><span class="line">    </span><br><span class="line">    plt.title(res_title)</span><br><span class="line">    plt.pie(counts, labels<span class="operator">=</span>labels, colors<span class="operator">=</span>colors[:len(labels)], autopct<span class="operator">=</span>&#x27;<span class="operator">%</span><span class="number">1</span>.1f<span class="operator">%%</span>&#x27;, startangle<span class="operator">=</span><span class="number">140</span>)</span><br><span class="line">    plt.legend(labels, title<span class="operator">=</span><span class="string">&quot;图例&quot;</span>, loc<span class="operator">=</span>&#x27;upper left&#x27;, bbox_to_anchor<span class="operator">=</span>(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">    </span><br><span class="line">    # 如果有图片路径传入,则保存图片,反之不保存<span class="operator">。</span></span><br><span class="line">    <span class="keyword">if</span> pic_path:</span><br><span class="line">        plt.savefig(pic_path)</span><br><span class="line">    </span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure></li>
<li><p>分析文本情感倾向分析函数<br>– 调用百度云API免费接口进行文本情感分析<br>PS：百度云API需注册验证获取API密钥，可免费调用50万次。<a target="_blank" rel="noopener" href="https://cloud.baidu.com/?from=console">注册地址</a><br>调用返回文本判定信息三种：积极、消极、中性，准确率较高，但调用速度慢,1小时处理1500条左右。<br> 安装百度云API接口包：pip install baidu-aip </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">def word_mean(text):</span><br><span class="line"></span><br><span class="line">    # 初始化<span class="type">AipNlp对象</span></span><br><span class="line">    <span class="type">APP_ID</span> <span class="operator">=</span> &#x27;自己申请注册的<span class="type">APP_ID</span>&#x27;</span><br><span class="line">    <span class="type">API_KEY</span> <span class="operator">=</span> &#x27;自己申请注册的 <span class="type">API_KEY</span> &#x27;</span><br><span class="line">    <span class="type">SECRET_KEY</span> <span class="operator">=</span> &#x27;自己申请注册的<span class="type">SECRET_KEY</span>&#x27;</span><br><span class="line">    </span><br><span class="line">    client <span class="operator">=</span> <span class="type">AipNlp</span>(<span class="type">APP_ID</span>, <span class="type">API_KEY</span>, <span class="type">SECRET_KEY</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot; 如果有可选参数 &quot;&quot;&quot;</span></span><br><span class="line">    options <span class="operator">=</span> &#123;&#125;</span><br><span class="line">    options[<span class="string">&quot;scene&quot;</span>] <span class="operator">=</span> <span class="string">&quot;talk&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot; 带参数调用对话情绪识别接口 &quot;&quot;&quot;</span></span><br><span class="line">    res <span class="operator">=</span> client.emotion(text, options)</span><br><span class="line">    res <span class="operator">=</span> &#123;item[&#x27;label&#x27;]: item[&#x27;prob&#x27;] <span class="keyword">for</span> item <span class="keyword">in</span> res[&#x27;items&#x27;]&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></li>
</ul>
<p>– 使用SnowNLP包<br>安装第三方库：pip install snownlp<br>完全免费且速度较快，但准确率不高，且只返回两种类型：积极和消极，可使用自定义词语进行模型训练，提高准确度。<br> 感觉可先调用百度云API获取部分数据的结果并将其喂给SnowNLP，但因为懒没展开这部分 ，具体可参考CSDN文章。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 使用<span class="type">SnowNLP对中文文本进行情感分析</span></span><br><span class="line"></span><br><span class="line">def sentiment_analysis(text):</span><br><span class="line"></span><br><span class="line">    s <span class="operator">=</span> <span class="type">SnowNLP</span>(text)</span><br><span class="line">    </span><br><span class="line">    # <span class="type">SnowNLP的sentiments方法返回情感倾向分数，越接近1表明情感越积极，越接近0表明情感越消极</span></span><br><span class="line">    sentiment_score <span class="operator">=</span> s.sentiments</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> sentiment_score  # 返回一个数字</span><br></pre></td></tr></table></figure>
<h3 id="数据总计分析"><a href="#数据总计分析" class="headerlink" title="数据总计分析"></a>数据总计分析</h3><h4 id="加微信时间"><a href="#加微信时间" class="headerlink" title="加微信时间"></a>加微信时间</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># strtime数据类型为对象,转换为时间格式</span><br><span class="line">data[&#x27;<span class="type">StrTime</span>&#x27;] <span class="operator">=</span> pd.to_datetime(data[&#x27;<span class="type">StrTime</span>&#x27;], format<span class="operator">=</span>&#x27;<span class="operator">%</span><span class="type">Y</span><span class="operator">-%</span>m<span class="operator">-%</span>d <span class="operator">%</span>H:<span class="operator">%</span>M:<span class="operator">%</span><span class="type">S</span>&#x27;)</span><br><span class="line"></span><br><span class="line"># <span class="number">1</span>.第一条聊天的信息，即<span class="type">StrTime最小的数</span></span><br><span class="line">the_first_time <span class="operator">=</span> np.min(data[&#x27;<span class="type">StrTime</span>&#x27;])</span><br><span class="line">the_first_time</span><br></pre></td></tr></table></figure>
<h4 id="相识多少天"><a href="#相识多少天" class="headerlink" title="相识多少天"></a>相识多少天</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">2</span>.距离今天是多少天</span><br><span class="line">from datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">days_difference <span class="operator">=</span> (datetime.today() <span class="operator">-</span> the_first_time).days</span><br><span class="line">days_difference</span><br></pre></td></tr></table></figure>
<h4 id="聊天数"><a href="#聊天数" class="headerlink" title="聊天数"></a>聊天数</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">3</span>.聊天天数：每天唯一值的计数</span><br><span class="line">chat_days <span class="operator">=</span> len(np.unique(data[&#x27;<span class="type">StrTime</span>&#x27;].dt.date))</span><br><span class="line">chat_days</span><br></pre></td></tr></table></figure>
<h4 id="信息发送数"><a href="#信息发送数" class="headerlink" title="信息发送数"></a>信息发送数</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 发送总条数</span><br><span class="line">data_num <span class="operator">=</span> len(data)</span><br><span class="line"></span><br><span class="line"># <span class="number">4</span>.总共相互发送信息条数</span><br><span class="line">every_chat_num <span class="operator">=</span> data.groupby(data[&#x27;<span class="type">IsSender</span>&#x27;])[&#x27;<span class="type">IsSender</span>&#x27;].count()</span><br><span class="line"></span><br><span class="line"># <span class="type">IsSender等于1</span>,为微信本人；<span class="type">IsSender等于0</span>,为对话者</span><br><span class="line"># 在dataframe中随机抽取一条微信本人的信息数据,获取微信本人昵称叫什么</span><br><span class="line"><span class="type">NickName_myself</span> <span class="operator">=</span> data[data[&#x27;<span class="type">IsSender</span>&#x27;] <span class="operator">==</span> <span class="number">1</span>].sample(n<span class="operator">=</span><span class="number">1</span>).loc[:,&#x27;<span class="type">NickName</span>&#x27;].values[<span class="number">0</span>]</span><br><span class="line"><span class="type">NickName_other</span> <span class="operator">=</span> data[data[&#x27;<span class="type">IsSender</span>&#x27;] <span class="operator">==</span> <span class="number">0</span>].sample(n<span class="operator">=</span><span class="number">1</span>).loc[:,&#x27;<span class="type">NickName</span>&#x27;].values[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"># 使用字典来重命名索引</span><br><span class="line">every_chat_num.index <span class="operator">=</span> every_chat_num.index.map(&#123;<span class="number">0</span>: <span class="type">NickName_other</span>, <span class="number">1</span>: <span class="type">NickName_myself</span>&#125;)</span><br><span class="line">every_chat_num</span><br></pre></td></tr></table></figure>
<h4 id="每天聊天情况"><a href="#每天聊天情况" class="headerlink" title="每天聊天情况"></a>每天聊天情况</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">5</span>.每天聊天信息</span><br><span class="line"></span><br><span class="line">heatmap_data <span class="operator">=</span> data.groupby([data[&#x27;<span class="type">StrTime</span>&#x27;].dt.isocalendar().week,data[&#x27;<span class="type">StrTime</span>&#x27;].dt.weekday])[&#x27;<span class="type">Sender</span>&#x27;].count().reset_index()</span><br><span class="line">heatmap_data <span class="operator">=</span> pd.<span class="type">DataFrame</span>(heatmap_data)</span><br><span class="line"></span><br><span class="line">pivot_table <span class="operator">=</span> heatmap_data.pivot(index<span class="operator">=</span>&#x27;<span class="type">StrTime</span>&#x27;, columns<span class="operator">=</span> &#x27;week&#x27;, values<span class="operator">=</span>&#x27;<span class="type">Sender</span>&#x27;)</span><br><span class="line">pivot_table <span class="operator">=</span> pivot_table.fillna(<span class="number">0</span>).astype(int)</span><br><span class="line"></span><br><span class="line">pivot_table.index <span class="operator">=</span> pivot_table.index.map(&#123;</span><br><span class="line">    <span class="number">0</span>: &#x27;星期一&#x27;,</span><br><span class="line">    <span class="number">1</span>: &#x27;星期二&#x27;,</span><br><span class="line">    <span class="number">2</span>: &#x27;星期三&#x27;,</span><br><span class="line">    <span class="number">3</span>: &#x27;星期四&#x27;,</span><br><span class="line">    <span class="number">4</span>: &#x27;星期五&#x27;,</span><br><span class="line">    <span class="number">5</span>: &#x27;星期六&#x27;,</span><br><span class="line">    <span class="number">6</span>: &#x27;星期日&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">pivot_table</span><br><span class="line"></span><br><span class="line"># 绘制热力图</span><br><span class="line"><span class="type">Draw_Heatmap</span>(pivot_table)</span><br></pre></td></tr></table></figure>
<img src="/img/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E5%8F%AF%E8%A7%86%E5%8C%96/%E7%83%AD%E5%8A%9B%E5%9B%BE.png" class="">

<h4 id="文本分析"><a href="#文本分析" class="headerlink" title="文本分析"></a>文本分析</h4><ul>
<li>文字总数<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">6</span>.所有文本信息字数</span><br><span class="line">all_text <span class="operator">=</span> data[data[&#x27;<span class="type">Type</span>&#x27;] <span class="operator">==</span> <span class="number">1</span>][&#x27;<span class="type">StrContent</span>&#x27;].dropna().astype(str).tolist()</span><br><span class="line">content <span class="operator">=</span> &#x27;&#x27;.join(all_text)</span><br><span class="line"></span><br><span class="line">total_str_count <span class="operator">=</span> len(content)</span><br><span class="line">total_str_count</span><br></pre></td></tr></table></figure></li>
<li>绘制文本信息词云图<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 绘制词云图</span><br><span class="line">content_word_pic_path <span class="operator">=</span> os.path.join(folder_path,&#x27;全部聊天词云图.png&#x27;)</span><br><span class="line">content_word_list <span class="operator">=</span> <span class="type">Draw_Yuntu</span>(content,content_word_pic_path)</span><br><span class="line"></span><br><span class="line">max_content_word_list_key,max_content_word_list_value  <span class="operator">=</span> <span class="type">Get_most_Value</span>(content_word_list)</span><br><span class="line">max_content_word_list_key,max_content_word_list_value</span><br></pre></td></tr></table></figure>
<img src="/img/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E5%8F%AF%E8%A7%86%E5%8C%96/%E8%AF%8D%E4%BA%91%E5%9B%BE.png" class=""></li>
<li>常用词频统计<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 最常说的<span class="number">20</span>个词</span><br><span class="line">content_word_list_top_20 <span class="operator">=</span> <span class="type">Get_top20</span>(content_word_list)</span><br><span class="line">content_word_list_top_20</span><br><span class="line"></span><br><span class="line"># 绘制图像</span><br><span class="line"><span class="type">Draw_Linegraph</span>(content_word_list_top_20,&#x27;前<span class="number">20</span>个最常发的词&#x27;)</span><br></pre></td></tr></table></figure>
<img src="/img/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E5%8F%AF%E8%A7%86%E5%8C%96/%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E5%9B%BE.png" class=""></li>
<li>文本情感分析<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 文本情感分析<span class="type">SnowNLP版本</span>,返回一个数</span><br><span class="line"></span><br><span class="line">res_final <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> all_text:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res_pro <span class="operator">=</span> sentiment_analysis(i)</span><br><span class="line">        <span class="keyword">if</span> res_pro <span class="operator">&gt;=</span> <span class="number">0.5</span>:</span><br><span class="line">            res_final.append(&#x27;积极&#x27;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res_final.append(&#x27;消极&#x27;)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    </span><br><span class="line">sentiment_analysis_res <span class="operator">=</span> <span class="type">Counter</span>(res_final)</span><br><span class="line">sentiment_analysis_res</span><br><span class="line"></span><br><span class="line"><span class="type">Draw_Piechart</span>(sentiment_analysis_res,&#x27;文本情感倾向分析&#x27;)</span><br></pre></td></tr></table></figure>
<img src="/img/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E5%8F%AF%E8%A7%86%E5%8C%96/%E6%96%87%E6%9C%AC%E6%83%85%E6%84%9F%E5%80%BE%E5%90%91%E5%9B%BE.png" class=""></li>
</ul>
<h3 id="详细信息分析"><a href="#详细信息分析" class="headerlink" title="详细信息分析"></a>详细信息分析</h3><h4 id="聊天最多的一天"><a href="#聊天最多的一天" class="headerlink" title="聊天最多的一天"></a>聊天最多的一天</h4><ul>
<li>获取该天日期<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 生成每天聊天信息记录</span><br><span class="line">day_chat_counts <span class="operator">=</span> data.groupby([data[&#x27;<span class="type">StrTime</span>&#x27;].dt.date])[&#x27;<span class="type">Sender</span>&#x27;].count().to_dict()</span><br><span class="line"></span><br><span class="line"># <span class="number">1</span>.聊天最多的一天及该天的信息数</span><br><span class="line">max_day_chat_counts_key,max_day_chat_counts_value <span class="operator">=</span> <span class="type">Get_most_Value</span>(day_chat_counts)</span><br><span class="line">max_day_chat_counts_key,max_day_chat_counts_value</span><br><span class="line">max_day_chat_day <span class="operator">=</span> max_day_chat_counts_key.strftime(<span class="string">&quot;%Y年%m月%d日&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li>查看文本内容并绘制云图<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">2</span>.查看聊天最多一天的信息内容</span><br><span class="line"># 获取聊天最多一天的数据</span><br><span class="line">max_day_chat_df <span class="operator">=</span> data[data[&#x27;<span class="type">StrTime</span>&#x27;].dt.date <span class="operator">==</span> max_day_chat_counts_key]</span><br><span class="line"></span><br><span class="line"># 获取文本信息作词频分析</span><br><span class="line">max_day_chat_content <span class="operator">=</span> &#x27;&#x27;.join(max_day_chat_df[max_day_chat_df[&#x27;<span class="type">Type</span>&#x27;] <span class="operator">==</span> <span class="number">1</span>][&#x27;<span class="type">StrContent</span>&#x27;].dropna().astype(str).tolist())</span><br><span class="line"></span><br><span class="line"># 绘制词云图</span><br><span class="line">max_day_chat_pic_path <span class="operator">=</span> os.path.join(folder_path,&#x27;最多聊天词云图.png&#x27;)</span><br><span class="line">max_day_chat_word_list <span class="operator">=</span> <span class="type">Draw_Yuntu</span>(max_day_chat_content,max_day_chat_pic_path)</span><br></pre></td></tr></table></figure></li>
<li>词频统计并绘制平滑曲线图<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">max_day_chat_word_list_key,max_day_chat_word_list_value  <span class="operator">=</span> <span class="type">Get_most_Value</span>(max_day_chat_word_list)</span><br><span class="line">max_day_chat_word_list_key,max_day_chat_word_list_value</span><br><span class="line"></span><br><span class="line">max_day_chat_word_list_top_20 <span class="operator">=</span> <span class="type">Get_top20</span>(max_day_chat_word_list)</span><br><span class="line">max_day_chat_word_list_top_20</span><br><span class="line"></span><br><span class="line"><span class="type">Draw_Linegraph</span>(max_day_chat_word_list_top_20,&#x27;前<span class="number">20</span>个最常发的词&#x27;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="各自发送的信息分析"><a href="#各自发送的信息分析" class="headerlink" title="各自发送的信息分析"></a>各自发送的信息分析</h4><ul>
<li>自己发送的信息分析<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 获取自己发送的数据</span><br><span class="line">data_myself <span class="operator">=</span> data[data[&#x27;<span class="type">IsSender</span>&#x27;] <span class="operator">==</span> <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"># 获取文本信息作词频分析</span><br><span class="line">data_myself_chat_content <span class="operator">=</span> &#x27;&#x27;.join(data_myself[data_myself[&#x27;<span class="type">Type</span>&#x27;] <span class="operator">==</span> <span class="number">1</span>][&#x27;<span class="type">StrContent</span>&#x27;].dropna().astype(str).tolist())</span><br><span class="line"></span><br><span class="line"># 绘制词云图</span><br><span class="line">data_myself_chat_word_list <span class="operator">=</span> <span class="type">Draw_Yuntu</span>(data_myself_chat_content)</span><br><span class="line"></span><br><span class="line"># 获取前<span class="number">20</span>个最常说的词汇</span><br><span class="line">data_myself_chat_word_list_top_20 <span class="operator">=</span> <span class="type">Get_top20</span>(data_myself_chat_word_list)</span><br><span class="line">data_myself_chat_word_list_top_20</span><br><span class="line"></span><br><span class="line"><span class="type">Draw_Linegraph</span>(data_myself_chat_word_list_top_20,&#x27;前<span class="number">20</span>个最常发的词&#x27;)</span><br></pre></td></tr></table></figure></li>
<li>对面发送的信息分析<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 获取对面发送的数据</span><br><span class="line"></span><br><span class="line">data_other <span class="operator">=</span> data[data[&#x27;<span class="type">IsSender</span>&#x27;] <span class="operator">==</span> <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"># 获取文本信息作词频分析</span><br><span class="line">data_other_chat_content <span class="operator">=</span> &#x27;&#x27;.join(data_other[data_other[&#x27;<span class="type">Type</span>&#x27;] <span class="operator">==</span> <span class="number">1</span>][&#x27;<span class="type">StrContent</span>&#x27;].dropna().astype(str).tolist())</span><br><span class="line"></span><br><span class="line"># 绘制词云图</span><br><span class="line">data_other_chat_word_list <span class="operator">=</span> <span class="type">Draw_Yuntu</span>(data_other_chat_content)</span><br><span class="line"></span><br><span class="line"># 获取前<span class="number">20</span>个最常说的词汇</span><br><span class="line">data_other_chat_word_list_top_20 <span class="operator">=</span> <span class="type">Get_top20</span>(data_other_chat_word_list)</span><br><span class="line">data_other_chat_word_list_top_20</span><br><span class="line"></span><br><span class="line"><span class="type">Draw_Linegraph</span>(data_other_chat_word_list_top_20,&#x27;前<span class="number">20</span>个最常发的词&#x27;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="最常聊天时段"><a href="#最常聊天时段" class="headerlink" title="最常聊天时段"></a>最常聊天时段</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 聊天时段划分</span><br><span class="line">def get_active_time(x):</span><br><span class="line">    start_hour <span class="operator">=</span>  (x.time().hour <span class="comment">// 2) * 2 </span></span><br><span class="line">    end_hour <span class="operator">=</span> start_hour <span class="operator">+</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> f<span class="string">&quot;&#123;start_hour:02&#125;:00 - &#123;end_hour:02&#125;:00&quot;</span></span><br><span class="line">    </span><br><span class="line">data[&#x27;active_time&#x27;] <span class="operator">=</span> list(map(lambda x : get_active_time(x), data[&#x27;<span class="type">StrTime</span>&#x27;]))</span><br><span class="line">time_counts <span class="operator">=</span> <span class="type">Counter</span>(data[&#x27;active_time&#x27;])</span><br><span class="line">most_common_time <span class="operator">=</span> time_counts.most_common(<span class="number">1</span>)[<span class="number">0</span>]   # 返回计数前面<span class="number">1</span>个最多的结果，结果为元组,<span class="number">2</span>就是返回前面最多的<span class="number">2</span>个</span><br><span class="line">most_common_time[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"># 绘制聊条时间断的图</span><br><span class="line">active_time_pic_path <span class="operator">=</span> os.path.join(folder_path,&#x27;活跃时间图.png&#x27;)</span><br><span class="line"><span class="type">Draw_Linegraph</span>(dict(sorted(time_counts.items())),&#x27;聊天时段汇总统计&#x27;,active_time_pic_path)</span><br></pre></td></tr></table></figure>

<h4 id="每周聊天情况分析"><a href="#每周聊天情况分析" class="headerlink" title="每周聊天情况分析"></a>每周聊天情况分析</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 统计每周聊天情况</span><br><span class="line">week_chat_counts <span class="operator">=</span> data.groupby([data[&#x27;<span class="type">StrTime</span>&#x27;].dt.weekday])[&#x27;<span class="type">Sender</span>&#x27;].count()</span><br><span class="line">week_chat_counts <span class="operator">=</span> pd.<span class="type">DataFrame</span>(week_chat_counts).reset_index()</span><br><span class="line"></span><br><span class="line"># 将星期几映射为名称</span><br><span class="line">week_chat_counts[&#x27;<span class="type">StrTime</span>&#x27;] <span class="operator">=</span> week_chat_counts[&#x27;<span class="type">StrTime</span>&#x27;].map(&#123;</span><br><span class="line">    <span class="number">0</span>: &#x27;周一&#x27;,</span><br><span class="line">    <span class="number">1</span>: &#x27;周二&#x27;,</span><br><span class="line">    <span class="number">2</span>: &#x27;周三&#x27;,</span><br><span class="line">    <span class="number">3</span>: &#x27;周四&#x27;,</span><br><span class="line">    <span class="number">4</span>: &#x27;周五&#x27;,</span><br><span class="line">    <span class="number">5</span>: &#x27;周六&#x27;,</span><br><span class="line">    <span class="number">6</span>: &#x27;周日&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">week_chat_counts[&#x27;weight&#x27;] <span class="operator">=</span> week_chat_counts[&#x27;<span class="type">Sender</span>&#x27;] <span class="operator">/</span> week_chat_counts[&#x27;<span class="type">Sender</span>&#x27;].sum()</span><br><span class="line">week_chat_counts</span><br><span class="line"></span><br><span class="line">top_two <span class="operator">=</span> week_chat_counts.nlargest(<span class="number">2</span>, &#x27;weight&#x27;)</span><br><span class="line">top_strtime <span class="operator">=</span> top_two[&#x27;<span class="type">StrTime</span>&#x27;].tolist()</span><br><span class="line"></span><br><span class="line"># 绘制饼图</span><br><span class="line">week_chat_counts_dict <span class="operator">=</span> dict(<span class="built_in">zip</span>(week_chat_counts[&#x27;<span class="type">StrTime</span>&#x27;],week_chat_counts[&#x27;weight&#x27;]))</span><br><span class="line"></span><br><span class="line">week_chat_pic_path <span class="operator">=</span> os.path.join(folder_path,&#x27;聊天星期图.png&#x27;)</span><br><span class="line"><span class="type">Draw_Piechart</span>(week_chat_counts_dict,&#x27;各星期聊天占比&#x27;,week_chat_pic_path)</span><br></pre></td></tr></table></figure>

<h2 id="自动生成PPT-PDF报告"><a href="#自动生成PPT-PDF报告" class="headerlink" title="自动生成PPT&amp;PDF报告"></a>自动生成PPT&amp;PDF报告</h2><p>可以直接利用数据生成HTML文档,但是因为不太会HTML，遂弃。原本还想着用Python连接H5，自动化生成H5，发现也不太可行。最后选择制作一份相对固定的PPT模板，利用Python对PPT内容进行修改，最后生成PDF文档。</p>
<h3 id="自动化生成PPT报告"><a href="#自动化生成PPT报告" class="headerlink" title="自动化生成PPT报告"></a>自动化生成PPT报告</h3><ul>
<li>准备一个可视化PPT模板，对需要更新文字图片的对象类型重新命名，方便后续Python一对一输入修改。【形状格式-选择窗口-修改对应的对象】</li>
<li>因为菜，所以暂时无法解决微信头像自动下载的问题，需要提前将俩人的微信头像放入“图片信息”文件夹【若不需要微信头像,replace_pic直接删除前2个元素】</li>
<li>用spire.presentation这个库转换PDF，图片清晰度会损失；但是用Win32一直报错,暂时解决不了。<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#  键是文本框名字,值是该文本框输入内容</span><br><span class="line"></span><br><span class="line">replace_content <span class="operator">=</span> &#123;</span><br><span class="line">    </span><br><span class="line">    &#x27;自己微信昵称&#x27;: <span class="type">NickName_myself</span>,</span><br><span class="line">    &#x27;对面微信昵称&#x27;: <span class="type">NickName_other</span>,</span><br><span class="line">    &#x27;第一次见面时间&#x27;: the_first_time.date(),</span><br><span class="line">    &#x27;相识天数&#x27;: days_difference,</span><br><span class="line">    &#x27;地球圈数&#x27;: round(days_difference <span class="operator">*</span> <span class="number">5</span> <span class="operator">*</span> <span class="number">24</span> <span class="operator">/</span> <span class="number">40076</span>, <span class="number">1</span>),</span><br><span class="line">    &#x27;发送信息数&#x27;: data_num,</span><br><span class="line">    &#x27;文本总数&#x27;: total_str_count,</span><br><span class="line">    &#x27;最常发送词&#x27;: max_content_word_list_key,</span><br><span class="line">    &#x27;词频数&#x27;: max_content_word_list_value,</span><br><span class="line">    &#x27;聊天最多一天&#x27;: max_day_chat_day,</span><br><span class="line">    &#x27;聊天最多一天信息数&#x27;: max_day_chat_counts_value,</span><br><span class="line">    &#x27;活跃时间段&#x27;: most_common_time[<span class="number">0</span>],</span><br><span class="line">    &#x27;最多星期&#x27;: top_strtime[<span class="number">0</span>],</span><br><span class="line">    &#x27;次多星期&#x27;: top_strtime[<span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 需要更新图片的位置</span><br><span class="line">replace_pic <span class="operator">=</span> [&#x27;自己头像&#x27;, &#x27;他人头像&#x27;, &#x27;全部聊天词云图&#x27;, &#x27;最多聊天词云图&#x27;, &#x27;活跃时间图&#x27;, &#x27;聊天星期图&#x27;]</span><br><span class="line"></span><br><span class="line">pptfile_name <span class="operator">=</span> &#x27;微信聊天可视化模板.pptx&#x27;</span><br><span class="line">pdffile_name <span class="operator">=</span> &#x27;微信聊天可视化.pdf&#x27;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="PPT文档转PDF文档"><a href="#PPT文档转PDF文档" class="headerlink" title="PPT文档转PDF文档"></a>PPT文档转PDF文档</h3><ul>
<li>若PPT文档中存在特殊字体，PPT文档需将文字嵌入文档，否则转换成PDF文字格式会出错。<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def <span class="type">Get_pdf</span>(replace_content, replace_pic, pptfile_name, pdffile_name, folder_path):</span><br><span class="line">    </span><br><span class="line">    # 打开现有的 <span class="type">PPT</span> 文件</span><br><span class="line">    ppt <span class="operator">=</span> pptx.<span class="type">Presentation</span>(pptfile_name)</span><br><span class="line"></span><br><span class="line">    # 遍历所有幻灯片</span><br><span class="line">    <span class="keyword">for</span> slide <span class="keyword">in</span> ppt.slides:</span><br><span class="line">        </span><br><span class="line">        # 记录头像的形状信息</span><br><span class="line">        avatar_shapes <span class="operator">=</span> []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> shape <span class="keyword">in</span> slide.shapes:</span><br><span class="line">            # 检查形状是否有文本框</span><br><span class="line">            <span class="keyword">if</span> hasattr(shape, <span class="string">&quot;text_frame&quot;</span>) and shape.name <span class="keyword">in</span> replace_content :</span><br><span class="line">                new_value <span class="operator">=</span> str(replace_content[shape.name])</span><br><span class="line">                <span class="keyword">for</span> paragraph <span class="keyword">in</span> shape.text_frame.paragraphs:</span><br><span class="line">                    <span class="keyword">for</span> run <span class="keyword">in</span> paragraph.runs:</span><br><span class="line">                        run.text <span class="operator">=</span> new_value</span><br><span class="line">                        new_value <span class="operator">=</span> <span class="string">&quot;&quot;</span>  # 避免多次重复替换</span><br><span class="line"></span><br><span class="line">            elif shape.shape_type <span class="operator">==</span> <span class="number">13</span> and <span class="built_in">any</span>(pic <span class="keyword">in</span> shape.name <span class="keyword">for</span> pic <span class="keyword">in</span> replace_pic):</span><br><span class="line">                pic_name <span class="operator">=</span> next(pic <span class="keyword">for</span> pic <span class="keyword">in</span> replace_pic <span class="keyword">if</span> pic <span class="keyword">in</span> shape.name)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> pic_name <span class="keyword">in</span> [&#x27;自己头像&#x27;, &#x27;他人头像&#x27;]:</span><br><span class="line">                    avatar_shapes.append((shape.left, shape.top, shape.width, shape.height, pic_name))</span><br><span class="line">                    slide.shapes._spTree.remove(shape._element)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    new_image_path <span class="operator">=</span> os.path.join(folder_path, pic_name <span class="operator">+</span> &#x27;.png&#x27;)</span><br><span class="line">                    slide.shapes.add_picture(new_image_path, shape.left, shape.top, width<span class="operator">=</span>shape.width, height<span class="operator">=</span>shape.height)</span><br><span class="line"></span><br><span class="line">        # 重新插入头像图片并下移一层<span class="operator">【</span>为了微信头像是圆形！<span class="operator">】</span></span><br><span class="line">        <span class="keyword">for</span> left, top, width, height, pic_name <span class="keyword">in</span> avatar_shapes:</span><br><span class="line">            new_image_path <span class="operator">=</span> os.path.join(folder_path, pic_name <span class="operator">+</span> &#x27;.png&#x27;)</span><br><span class="line">            new_shape <span class="operator">=</span> slide.shapes.add_picture(new_image_path, left, top, width<span class="operator">=</span>width, height<span class="operator">=</span>height)</span><br><span class="line">            slide.shapes._spTree.remove(new_shape._element)</span><br><span class="line">            slide.shapes._spTree.insert(<span class="number">0</span>, new_shape._element)</span><br><span class="line"></span><br><span class="line">    new_ppt_name <span class="operator">=</span> os.path.abspath(f&#x27;&#123;pptfile_name.split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>]&#125;生成结果.pptx&#x27;)   # 生成<span class="type">PPT内容</span></span><br><span class="line">    ppt.save(new_ppt_name)</span><br><span class="line"></span><br><span class="line">    # <span class="type">PDF</span> 转换</span><br><span class="line">    presentation <span class="operator">=</span> <span class="type">Presentation</span>()</span><br><span class="line">    presentation.<span class="type">LoadFromFile</span>(new_ppt_name)</span><br><span class="line">    presentation.<span class="type">SaveToFile</span>(pdffile_name, <span class="type">FileFormat</span>.<span class="type">PDF</span>)</span><br><span class="line">    presentation.<span class="type">Dispose</span>()</span><br><span class="line"></span><br><span class="line"># 调用</span><br><span class="line"><span class="type">Get_pdf</span>(replace_content, replace_pic, pptfile_name, pdffile_name, folder_path)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">AquaMind</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/09/26/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%AF%E8%A7%86%E5%8C%96/">http://example.com/2024/09/26/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%AF%E8%A7%86%E5%8C%96/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">AquaMind✨</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a></div><div class="post-share"><div class="social-share" data-image="/img/default_cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/11/01/%E7%BB%98%E5%88%B6%E4%B8%AD%E5%9B%BD%E7%83%AD%E5%8A%9B%E5%9C%B0%E5%9B%BE/" title="利用Excel绘制中国热力地图"><img class="cover" src="https://maodoo.oss-cn-beijing.aliyuncs.com/20241210172528345.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">利用Excel绘制中国热力地图</div></div><div class="info-2"><div class="info-item-1">准备工作工具准备 Excel365版本 WPS非会员安装VBA插件 将文档启用宏模式并另存为宏工作簿：文件-选项-信任中心-宏设置-启用VBA  数据准备 2023年全国各省行政区人口数据 广东省2023年各市GDP数据  数据范围划分 方法1：直接利用分位数划分数据（直接用五分位数将全国人口数据划分为五等份，分界值&#x3D;ROUNDUP(PERCENTILE(数据所在列,分位点),0)） 方法2：结合数据实际，自定义数据范围（如本例的划分）  色块填充 颜色列文本框填充不同颜色  导入模板地图 可在阿里云地图下载SVG格式的矢量地图模板,并导入excel 矢量地图各板块命名：在Excel右上角处逐一修改各省市模块名称。  VBA代码编辑 代码逻辑：遍历所有行，在每次循环中获取B列的人口数据，对其进行规则判断，取得对应规则单元格的背景色，用该背景色填充该行对应的省份名称形状。  123456789101112131415161718192021222324252627282930313233Sub SetMapColor()    Dim i As Integer ...</div></div></div></a><a class="pagination-related" href="/2024/09/07/hello-world/" title="Hello World"><img class="cover" src="https://maodoo.oss-cn-beijing.aliyuncs.com/20241210172459243.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/12/11/%E5%B8%82%E5%9C%BA%E7%A0%94%E7%A9%B6%E6%B3%95%E7%9A%84Python%E5%AE%9E%E7%8E%B0/" title="事件研究法的Python实现"><img class="cover" src="/img/default_cover.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-11</div><div class="info-item-2">事件研究法的Python实现</div></div><div class="info-2"><div class="info-item-1"> 小白笔记,谨慎食用  什么是时间研究法？ 事件研究法 (Event Study...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">AquaMind</div><div class="author-info-description">N&F37.2❤️</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fa-solid fa-file-signature fa-bounce"></i><span>FOLLOW ME</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Ashelyjiang" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="mailto:1575017857@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a><a class="social-icon" href="https://music.163.com" target="_blank" title="music"><i class="fa-solid fa-music" style="color: #000000;"></i></a><a class="social-icon" href="/wechat/" target="_blank" title="公众号"><i class="fa-solid fa-blog" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">狗都不学商科专业↔️啥都爱学一点选手↔️本质菜鸡 ↔️欢迎留言交流</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96"><span class="toc-number">1.</span> <span class="toc-text">数据获取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E8%84%91%E7%AB%AF%E8%BF%81%E7%A7%BB%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">电脑端迁移聊天记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E7%95%99%E7%97%95%E8%BD%AF%E4%BB%B6-%E8%8E%B7%E5%8F%96%E7%94%B5%E8%84%91%E7%AB%AF%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95"><span class="toc-number">1.2.</span> <span class="toc-text">下载留痕软件 获取电脑端微信聊天记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">1.3.</span> <span class="toc-text">导出数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">数据分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">2.1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-number">2.1.1.</span> <span class="toc-text">导入第三方库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.2.</span> <span class="toc-text">导入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%BB%98%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.3.</span> <span class="toc-text">图像绘制函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%80%BB%E8%AE%A1%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">数据总计分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%BE%AE%E4%BF%A1%E6%97%B6%E9%97%B4"><span class="toc-number">2.2.1.</span> <span class="toc-text">加微信时间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E8%AF%86%E5%A4%9A%E5%B0%91%E5%A4%A9"><span class="toc-number">2.2.2.</span> <span class="toc-text">相识多少天</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%8A%E5%A4%A9%E6%95%B0"><span class="toc-number">2.2.3.</span> <span class="toc-text">聊天数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E5%8F%91%E9%80%81%E6%95%B0"><span class="toc-number">2.2.4.</span> <span class="toc-text">信息发送数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%8F%E5%A4%A9%E8%81%8A%E5%A4%A9%E6%83%85%E5%86%B5"><span class="toc-number">2.2.5.</span> <span class="toc-text">每天聊天情况</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E5%88%86%E6%9E%90"><span class="toc-number">2.2.6.</span> <span class="toc-text">文本分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF%E5%88%86%E6%9E%90"><span class="toc-number">2.3.</span> <span class="toc-text">详细信息分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%8A%E5%A4%A9%E6%9C%80%E5%A4%9A%E7%9A%84%E4%B8%80%E5%A4%A9"><span class="toc-number">2.3.1.</span> <span class="toc-text">聊天最多的一天</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%84%E8%87%AA%E5%8F%91%E9%80%81%E7%9A%84%E4%BF%A1%E6%81%AF%E5%88%86%E6%9E%90"><span class="toc-number">2.3.2.</span> <span class="toc-text">各自发送的信息分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%B8%B8%E8%81%8A%E5%A4%A9%E6%97%B6%E6%AE%B5"><span class="toc-number">2.3.3.</span> <span class="toc-text">最常聊天时段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%8F%E5%91%A8%E8%81%8A%E5%A4%A9%E6%83%85%E5%86%B5%E5%88%86%E6%9E%90"><span class="toc-number">2.3.4.</span> <span class="toc-text">每周聊天情况分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90PPT-PDF%E6%8A%A5%E5%91%8A"><span class="toc-number">3.</span> <span class="toc-text">自动生成PPT&amp;PDF报告</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E7%94%9F%E6%88%90PPT%E6%8A%A5%E5%91%8A"><span class="toc-number">3.1.</span> <span class="toc-text">自动化生成PPT报告</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PPT%E6%96%87%E6%A1%A3%E8%BD%ACPDF%E6%96%87%E6%A1%A3"><span class="toc-number">3.2.</span> <span class="toc-text">PPT文档转PDF文档</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/11/%E5%B8%82%E5%9C%BA%E7%A0%94%E7%A9%B6%E6%B3%95%E7%9A%84Python%E5%AE%9E%E7%8E%B0/" title="事件研究法的Python实现"><img src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="事件研究法的Python实现"/></a><div class="content"><a class="title" href="/2024/12/11/%E5%B8%82%E5%9C%BA%E7%A0%94%E7%A9%B6%E6%B3%95%E7%9A%84Python%E5%AE%9E%E7%8E%B0/" title="事件研究法的Python实现">事件研究法的Python实现</a><time datetime="2024-12-11T12:47:48.980Z" title="发表于 2024-12-11 20:47:48">2024-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/19/Nodejs%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="Hexo+Nodejs+GitHub创建个人博客"><img src="https://maodoo.oss-cn-beijing.aliyuncs.com/20241210172528345.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo+Nodejs+GitHub创建个人博客"/></a><div class="content"><a class="title" href="/2024/11/19/Nodejs%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="Hexo+Nodejs+GitHub创建个人博客">Hexo+Nodejs+GitHub创建个人博客</a><time datetime="2024-11-19T11:24:18.525Z" title="发表于 2024-11-19 19:24:18">2024-11-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/01/%E7%BB%98%E5%88%B6%E4%B8%AD%E5%9B%BD%E7%83%AD%E5%8A%9B%E5%9C%B0%E5%9B%BE/" title="利用Excel绘制中国热力地图"><img src="https://maodoo.oss-cn-beijing.aliyuncs.com/20241210172528345.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利用Excel绘制中国热力地图"/></a><div class="content"><a class="title" href="/2024/11/01/%E7%BB%98%E5%88%B6%E4%B8%AD%E5%9B%BD%E7%83%AD%E5%8A%9B%E5%9C%B0%E5%9B%BE/" title="利用Excel绘制中国热力地图">利用Excel绘制中国热力地图</a><time datetime="2024-11-01T12:46:45.495Z" title="发表于 2024-11-01 20:46:45">2024-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/26/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%AF%E8%A7%86%E5%8C%96/" title="微信聊天记录可视化"><img src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信聊天记录可视化"/></a><div class="content"><a class="title" href="/2024/09/26/%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95%E5%8F%AF%E8%A7%86%E5%8C%96/" title="微信聊天记录可视化">微信聊天记录可视化</a><time datetime="2024-09-26T04:56:22.630Z" title="发表于 2024-09-26 12:56:22">2024-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/07/hello-world/" title="Hello World"><img src="https://maodoo.oss-cn-beijing.aliyuncs.com/20241210172459243.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2024/09/07/hello-world/" title="Hello World">Hello World</a><time datetime="2024-09-06T17:49:52.368Z" title="发表于 2024-09-07 01:49:52">2024-09-07</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">寄语🧬</p><div class="bg-ad"><div>我将玫瑰藏于身后，风起花落，从此鲜花赠自己，纵马踏花向自由✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启开心的一天</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">魔改指南</a><a href="/box/nav/">网站导航</a></li><li><a href="/comments/">标签分类</a><a href="/personal/about/">音乐分类</a></li><li><a href="/comments/">今日关注</a><a href="/personal/about/">本周emo</a></li><li><a href="/comments/">说点什么</a><a href="/personal/about/">关于作者</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://ashelyjiang.github.io/" title="AquaMind✨"><img src=" /img/avatar.jpg" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2024</b></span><span><b>&nbsp;&nbsp;By AquaMind</b></span></div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div id="workboard"></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-api-seven-topaz.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-api-seven-topaz.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas id="snow"></canvas><script async src="/js/snow.js"></script><canvas id="universe"></canvas><script async src="/js/universe.js"></script><script src="https://code.jquery.com/jquery-3.6.0.min.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script><script defer src="/js/welcome.js"></script><script defer src="/js/runtime.js"></script><div class="aplayer no-destroy" data-id="420500290" data-server="netease" data-type="song" data-fixed="true" data-autoplay="true" data-lrctype="0"> </div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async data-pjax src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><script async data-pjax src="/js/newYear.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="祝,博,主,发,财" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>